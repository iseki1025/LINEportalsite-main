<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ „é¤Šæƒ…å ± | æ¢¶æœ¬ã‚¯ãƒªãƒ‹ãƒƒã‚¯</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="components.css">
</head>

<body>
    <!-- Header -->
    <header class="app-header">
        <a href="friend-main.html" class="back-arrow">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
        </a>
        <div class="header-logo">æ „é¤Šæƒ…å ±</div>
    </header>

    <main class="main-content">
        <!-- Hero - Orange/Amber theme -->
        <section class="hero-card" style="background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);">
            <h1 class="hero-title" style="font-size: 1.3rem;">é£Ÿäº‹ç™‚æ³•ã®åŸºæœ¬</h1>
            <p class="hero-sub">é©åˆ‡ãªé£Ÿäº‹ç®¡ç†ã§é€æã‚’æ¥½ã«ã—ã€<br>åˆä½µç—‡ã‚’äºˆé˜²ã—ã¾ã—ã‚‡ã†ã€‚</p>
        </section>

        <!-- 5 Basics Grid -->
        <h2 class="section-title">ğŸ½ï¸ é£Ÿäº‹ç™‚æ³•ã®5ã¤ã®åŸºæœ¬</h2>
        <div class="bento-grid">
            <div class="bento-card" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);">
                <div class="card-icon-container" style="color: #d97706;">ğŸ’§</div>
                <div class="card-title" style="color: #b45309;">æ°´åˆ†ãƒ»å¡©åˆ†</div>
                <div class="card-desc">æ‘‚ã‚Šã™ãã¯è¡€åœ§ä¸Šæ˜‡ã‚„å¿ƒè² æ‹…ã®åŸå› ã«</div>
            </div>
            <div class="bento-card" style="background: linear-gradient(135deg, #fed7aa 0%, #fdba74 100%);">
                <div class="card-icon-container" style="color: #c2410c;">ğŸŒ</div>
                <div class="card-title" style="color: #9a3412;">ã‚«ãƒªã‚¦ãƒ </div>
                <div class="card-desc">é‡èœã‚„æœç‰©ã¯èŒ¹ã§ã“ã¼ã—ç­‰ã®å·¥å¤«ã‚’</div>
            </div>
            <div class="bento-card" style="background: linear-gradient(135deg, #ffedd5 0%, #fed7aa 100%);">
                <div class="card-icon-container" style="color: #ea580c;">ğŸ§€</div>
                <div class="card-title" style="color: #c2410c;">ãƒªãƒ³</div>
                <div class="card-desc">åŠ å·¥é£Ÿå“ã‚„ä¹³è£½å“ã«æ³¨æ„ã—ã¾ã—ã‚‡ã†</div>
            </div>
            <div class="bento-card" style="background: linear-gradient(135deg, #fef9c3 0%, #fef08a 100%);">
                <div class="card-icon-container" style="color: #ca8a04;">ğŸ¥©</div>
                <div class="card-title" style="color: #a16207;">ãŸã‚“ã±ãè³ª</div>
                <div class="card-desc">æ‘‚ã‚Šã™ãã‚‹ã¨è€å»ƒç‰©ãŒå¢—ãˆã¾ã™</div>
            </div>
        </div>

        <!-- Energy card (full width) -->
        <div style="padding: 0 1rem;">
            <div class="bento-card"
                style="background: linear-gradient(135deg, #fef3c7 0%, #fcd34d 100%); flex-direction: row; text-align: left; padding: 1rem;">
                <div class="card-icon-container"
                    style="color: #d97706; width: 48px; height: 48px; margin-right: 1rem; margin-bottom: 0;">âš¡</div>
                <div>
                    <div class="card-title" style="color: #b45309; margin-bottom: 0.2rem;">ã‚¨ãƒãƒ«ã‚®ãƒ¼</div>
                    <div class="card-desc">ç‚­æ°´åŒ–ç‰©ã‚„è„‚è³ªã§ã—ã£ã‹ã‚Šç¢ºä¿ã—ã¾ã—ã‚‡ã†</div>
                </div>
            </div>
        </div>

        <!-- Recipe Section -->
        <h2 class="section-title">ğŸ³ ãŠã™ã™ã‚ãƒ¬ã‚·ãƒ”</h2>
        <div id="recipeContainer" style="padding: 0 1rem;">
            <p style="text-align:center; padding:2rem; color:#888;">èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>

        <!-- Quiz Link -->
        <h2 class="section-title">ğŸ“ çŸ¥è­˜ã‚’ãƒã‚§ãƒƒã‚¯</h2>
        <div style="padding: 0 1rem;">
            <a href="friend-nutrition-quiz.html" class="bento-card"
                style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); text-decoration: none;">
                <div class="card-icon-container" style="color: #d97706;">
                    <svg viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                </div>
                <div class="card-title" style="color: #b45309;">æ „é¤Šã‚¯ã‚¤ã‚ºã«æŒ‘æˆ¦</div>
                <div class="card-desc">é£Ÿäº‹ç®¡ç†ã«å½¹ç«‹ã¤çŸ¥è­˜ã‚’ã‚²ãƒ¼ãƒ æ„Ÿè¦šã§ï¼</div>
            </a>
        </div>

        <!-- Q&A Section -->
        <h2 class="section-title">â“ æ „é¤ŠQ&A</h2>
        <section class="qa-search-section" data-csv-path="files/data/qa-data.csv" data-category="æ „é¤Š"
            style="padding: 0 1rem 1rem;">
            <div class="qa-search-container" style="margin-bottom:1rem;">
                <input type="search" class="qa-search-input" placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ (ä¾‹: ãƒªãƒ³, å¤–é£Ÿ)" autocomplete="off"
                    style="width:100%; padding:12px; border-radius:12px; border:2px solid #fbbf24; background:white;">
            </div>
            <div class="keyword-buttons" style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:1.5rem;">
                <button class="keyword-button" onclick="setKeyword('ãƒªãƒ³')"
                    style="background: #fef3c7; color: #b45309;">ãƒªãƒ³</button>
                <button class="keyword-button" onclick="setKeyword('ã‚«ãƒªã‚¦ãƒ ')"
                    style="background: #fef3c7; color: #b45309;">ã‚«ãƒªã‚¦ãƒ </button>
                <button class="keyword-button" onclick="setKeyword('å¡©åˆ†')"
                    style="background: #fef3c7; color: #b45309;">å¡©åˆ†</button>
            </div>
            <div class="qa-results-container"></div>
        </section>

        <div style="text-align: center; font-size: 0.75rem; color: #94a3b8; padding: 2rem 0;">
            &copy; 2025 Kajimoto Clinic
        </div>
    </main>

    <!-- Bottom Nav -->
    <nav class="bottom-nav">
        <a href="index.html" class="nav-item">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
            <span>ãƒ›ãƒ¼ãƒ </span>
        </a>
        <a href="friend-main.html" class="nav-item active">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
                <polyline points="20 12 20 22 4 22 4 12"></polyline>
                <rect x="2" y="7" width="20" height="5"></rect>
                <line x1="12" y1="22" x2="12" y2="7"></line>
                <path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"></path>
                <path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"></path>
            </svg>
            <span>ç‰¹å…¸</span>
        </a>
        <a href="disaster-main.html" class="nav-item">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z">
                </path>
                <line x1="12" y1="9" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            <span>ç½å®³</span>
        </a>
        <a href="qa-main.html" class="nav-item">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            <span>Q&A</span>
        </a>
    </nav>

    <script>
        window.setKeyword = function (word) {
            const input = document.querySelector('.qa-search-input');
            if (input) { input.value = word; input.dispatchEvent(new Event('input', { bubbles: true })); }
        }
        function togglePdf(header) {
            const container = header.parentElement;
            container.classList.toggle('is-open');
        }
        window.togglePdf = togglePdf;
    </script>

    <!-- Firebase Logic -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, getDocs, orderBy, query } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { firebaseConfig } from './js/firebase-config.js';

        try {
            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);

            async function loadRecipes() {
                const container = document.getElementById('recipeContainer');
                try {
                    const q = query(collection(db, 'recipes'), orderBy('uploadedAt', 'desc'));
                    const snapshot = await getDocs(q);

                    if (snapshot.empty) {
                        container.innerHTML = '<p style="text-align:center; color:#888;">ãƒ¬ã‚·ãƒ”ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
                        return;
                    }

                    container.innerHTML = snapshot.docs.map(doc => {
                        const data = doc.data();
                        return `
                        <div class="pdf-collapsible" style="border: 2px solid #fbbf24; border-radius: 12px; margin-bottom: 0.75rem; overflow: hidden;">
                            <div class="pdf-collapsible-header" onclick="togglePdf(this)" style="background: #fef3c7; padding: 1rem; cursor: pointer; display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-weight: bold; color: #b45309;">ğŸ³ ${data.title}</span>
                                <span style="color: #d97706;">â–¼</span>
                            </div>
                            <div class="pdf-collapsible-content" style="display: none; padding: 1rem; background: white;">
                                <div style="text-align:center;">
                                    <a href="${data.storageUrl}" target="_blank" class="pdf-link-mobile" style="background: #f59e0b;">PDFã‚’é–‹ã</a>
                                </div>
                            </div>
                        </div>
                        `;
                    }).join('');
                } catch (error) {
                    console.error('Recipe error:', error);
                    container.innerHTML = '<p style="color:red; text-align:center;">ãƒ¬ã‚·ãƒ”ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ</p>';
                }
            }
            loadRecipes();
        } catch (e) {
            console.error('Firebase init error:', e);
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="js/qa/qa-data-embedded.js"></script>
    <script src="js/qa/qa-script.js"></script>
</body>

</html>